\section{Machine Code Emitters}

\subsubsection{Overview}
MLRISC lets the client to directly emit machine code and bypass the traditional
assembly mechanism. 

Machine code emitters in MLRISC satisfy the api 
\mlrischref{emit/instruction-emitter.api}{INSTRUCTION\_EMITTER},
which is defined as:
\begin{SML}
api Instruction_Emitter =
sig

   package i : \href{instructions.html}{Instruction_Set}
   package c : \href{cells.html}{Cells}
   package s : \href{streams.html}{Instruction_Stream}
   package p : \href{pseudo-ops.html}{Pseudo_Ops}
      sharing I.C = C  
      sharing S.P = P

   my make_stream : Annotations.annotations ->
                     ((int -> int) -> I.instruction -> Void,
                      Void,'b,'c,'d,'e) S.stream

end
\end{SML}

The function \sml{make_stream} returns an instruction stream.
The output, a stream of bytes, is direct to the client supplied
package which satisfy the 
\mlrischref{emit/code-string.api}{CODE\_STRING} interface.
This api is defined as follows:
\begin{SML}
api Code_String = sig
  type code_string
  my init          : int -> Void
  my update        : int * unt8.word -> Void
  my getCodeString : Void -> code_string
end
\end{SML}

\subsubsection{More Details}

Machine code emitters are automatically generated by the 
\href{mlrisc-md.html}{MDGen} tool.  Some specific generated
emitters are listed below:
\begin{enumerate}
 \item \mlrischref{sparc/emit/sparcMC.sml}{Sparc}
 \item \mlrischref{ppc/emit/ppcMC.sml}{Power PC}
 \item \mlrischref{x86/emit/x86MC.sml}{X86}
\end{enumerate}
